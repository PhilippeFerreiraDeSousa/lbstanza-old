defpackage stz/macro-plugin :
  import core
  import collections
  import stz/fastio-runtime
  import stz/plugin-utils
  import stz/sexp-serializer

;The plugin receiver utility
val PLUGIN-RECEIVER = PluginReceiver(SExpIO())

;The entry-point to the macro plugin.
extern defn macroexpand (input:ptr<byte>) -> ptr<byte> :
  return receive(PLUGIN-RECEIVER, input, fn(macroexpand-sexp))

defn macroexpand-sexp (sexp) -> ? :
  "Hello world"